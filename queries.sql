

#1 
SELECT flightid FROM flights ORDER BY flightid DESC LIMIT 1;

 flightid
----------
     4758
(1 riga)

#2
SELECT origin, AVG(arrdelay) as Average_arrdelay, AVG(depdelay) as Average_depdelay 
FROM flights 
GROUP BY origin 
ORDER BY origin ASC;

origin |    average_arrdelay     |    average_depdelay
--------+-------------------------+-------------------------
 ABE    |     17.1250000000000000 |     15.7500000000000000
 ABQ    |      3.8157894736842105 |      6.8684210526315789
 ABY    |      4.5000000000000000 |     19.0000000000000000
 AGS    |     19.0000000000000000 |     15.3333333333333333
 ALB    |     -2.2500000000000000 | -0.12500000000000000000
 AMA    |      1.2500000000000000 |  0.00000000000000000000
 ANC    |      1.8571428571428571 |      3.5000000000000000
 ASE    |      7.0000000000000000 |     10.0000000000000000
 ATL    |      9.5719844357976654 |      9.8832684824902724
 ATW    |  0.66666666666666666667 |      1.6666666666666667
 AUS    |      1.5454545454545455 |      1.2272727272727273
 AVL    |     -7.6666666666666667 |     -3.3333333333333333
 AZO    |    -10.0000000000000000 |     -5.0000000000000000
 BDL    |     -4.4347826086956522 |      2.7826086956521739
 BET    |  1.00000000000000000000 |     -2.0000000000000000
 BFL    |     -6.0000000000000000 |  0.00000000000000000000
 BGR    |     45.0000000000000000 |     60.0000000000000000
 BHM    |      5.7500000000000000 |      8.3750000000000000
 BIL    |     14.0000000000000000 |      4.5000000000000000
 BIS    |     17.0000000000000000 |  0.00000000000000000000
 BNA    |      7.8936170212765957 |      8.9574468085106383
 BOI    |      3.6666666666666667 |      2.0000000000000000
 BOS    |      5.8285714285714286 |      8.3238095238095238
 BTR    |      7.6666666666666667 | -0.83333333333333333333
 BTV    |    -11.4444444444444444 |     -4.0000000000000000
 BUF    |      1.6818181818181818 |      4.4090909090909091
 BUR    |      6.0000000000000000 |      6.6666666666666667
 BWI    |     13.2794117647058824 |     12.4558823529411765
 BZN    |     -5.5000000000000000 |     -1.5000000000000000
.

#3
SELECT origin, colyear, colmonth, AVG(arrdelay) as Average_arrdelay 
FROM flights
GROUP BY origin, colyear, colmonth
ORDER BY origin ASC;


 origin | colyear | colmonth |    average_arrdelay
--------+---------+----------+-------------------------
 ABE    |    1992 |        6 |     -5.0000000000000000
 ABE    |    1991 |        7 |     10.0000000000000000
 ABE    |    2006 |        1 |     60.0000000000000000
 ABE    |    1988 |       11 |     26.0000000000000000
 ABE    |    2005 |        1 |    -18.0000000000000000
 ABE    |    1988 |        5 |     73.0000000000000000
 ABE    |    1990 |       12 |     -5.0000000000000000
 ABE    |    1990 |        1 |     -4.0000000000000000
 ABQ    |    2006 |        6 |     16.5000000000000000
 ABQ    |    2006 |        1 |  0.00000000000000000000
 ABQ    |    2002 |        7 |    -12.0000000000000000
 ABQ    |    2007 |        1 |    -10.0000000000000000
 ABQ    |    2004 |        6 |      8.0000000000000000
 ABQ    |    1995 |        7 | -1.00000000000000000000
 ABQ    |    1998 |        1 |     -5.0000000000000000
 ABQ    |    1999 |        4 |     -2.0000000000000000
 ABQ    |    1990 |        4 |     -3.0000000000000000
 ABQ    |    2003 |        8 | -1.00000000000000000000
 ABQ    |    1991 |        1 |      6.0000000000000000
 ABQ    |    1999 |       10 |      3.0000000000000000
 ABQ    |    1997 |       11 |    -11.0000000000000000
 ABQ    |    2005 |        7 |      9.0000000000000000
 ABQ    |    2002 |        8 |     35.0000000000000000
 ABQ    |    1996 |        7 |  0.00000000000000000000
 ABQ    |    2006 |        7 | -1.00000000000000000000
 ABQ    |    1998 |        3 |      9.0000000000000000
 ABQ    |    1997 |       10 |     12.0000000000000000
 ABQ    |    1995 |        1 |     -8.0000000000000000
 ABQ    |    1995 |        9 |     -2.0000000000000000
 ABQ    |    1989 |        1 |      7.0000000000000000
 ABQ    |    1993 |       11 |      3.0000000000000000
 ABQ    |    1994 |        1 |     12.0000000000000000
 ABQ    |    1987 |       10 |     10.0000000000000000
 ABQ    |    1995 |        8 |      7.0000000000000000
 ABQ    |    1996 |        1 | -1.00000000000000000000
 ABQ    |    2002 |        9 |     -6.0000000000000000
 ABQ    |    2004 |        9 |     -3.0000000000000000
 ABQ    |    1997 |       12 |     14.0000000000000000
 
.


#4
SELECT city, colyear, colmonth, AVG(arrdelay) as Average_arrdelay 
FROM usairports
INNER JOIN flights 
    ON usairports.iata = flights.origin
GROUP BY city, colyear, colmonth
ORDER BY city ASC;

              city              | colyear | colmonth |    average_arrdelay
--------------------------------+---------+----------+-------------------------
 Albany                         |    1988 |        3 |     -6.0000000000000000
 Albany                         |    1992 |       12 |    -18.0000000000000000
 Albany                         |    1993 |       10 |  0.00000000000000000000
 Albany                         |    1994 |       10 |    -11.0000000000000000
 Albany                         |    2003 |        3 |     -4.0000000000000000
 Albany                         |    2004 |       10 |  1.00000000000000000000
 Albany                         |    2006 |        1 |     -8.0000000000000000
 Albany                         |    2006 |        3 |     17.0000000000000000
 Albany                         |    2007 |        6 |      5.0000000000000000
 Albany                         |    2008 |       12 |     15.0000000000000000
 Albuquerque                    |    1987 |       10 |     10.0000000000000000
 Albuquerque                    |    1989 |        1 |      7.0000000000000000
 Albuquerque                    |    1990 |        4 |     -3.0000000000000000
 Albuquerque                    |    1991 |        1 |      6.0000000000000000
 Albuquerque                    |    1993 |       11 |      3.0000000000000000
 Albuquerque                    |    1994 |        1 |     12.0000000000000000
 Albuquerque                    |    1995 |        1 |     -8.0000000000000000
 Albuquerque                    |    1995 |        7 | -1.00000000000000000000
 Albuquerque                    |    1995 |        8 |      7.0000000000000000
 Albuquerque                    |    1995 |        9 |     -2.0000000000000000
 Albuquerque                    |    1996 |        1 | -1.00000000000000000000
 Albuquerque                    |    1996 |        7 |  0.00000000000000000000
 Albuquerque                    |    1997 |        9 |     -8.0000000000000000
 Albuquerque                    |    1997 |       10 |     12.0000000000000000
 Albuquerque                    |    1997 |       11 |    -11.0000000000000000
 Albuquerque                    |    1997 |       12 |     14.0000000000000000
 Albuquerque                    |    1998 |        1 |     -5.0000000000000000
 Albuquerque                    |    1998 |        3 |      9.0000000000000000
 Albuquerque                    |    1998 |        8 |     -2.0000000000000000
 Albuquerque                    |    1999 |        4 |     -2.0000000000000000
 Albuquerque                    |    1999 |       10 |      3.0000000000000000
 Albuquerque                    |    2002 |        6 |     89.0000000000000000
 Albuquerque                    |    2002 |        7 |    -12.0000000000000000
 Albuquerque                    |    2002 |        8 |     35.0000000000000000
 Albuquerque                    |    2002 |        9 |     -6.0000000000000000
 Albuquerque                    |    2003 |        2 |    -27.0000000000000000
 Albuquerque                    |    2003 |        8 | -1.00000000000000000000
 Albuquerque                    |    2004 |        6 |      8.0000000000000000
.


#5
SELECT uniquecarrier, colyear, colmonth, SUM (case when cancelled = true then 1 else 0 end) as total_cancelled
FROM flights
GROUP BY uniquecarrier, colyear, colmonth
ORDER BY total_cancelled DESC;

uniquecarrier | colyear | colmonth | total_cancelled
---------------+---------+----------+-----------------
 DL            |    1988 |        1 |               3
 AS            |    1989 |        8 |               1
 AS            |    1988 |        9 |               1
 UA            |    1989 |        2 |               1
 TW            |    1987 |       11 |               1
 US            |    1987 |       12 |               1
 UA            |    1990 |        2 |               1
 CO            |    1988 |        2 |               1
 PI            |    1988 |        7 |               1
 DL            |    1990 |        5 |               1
 AA            |    1989 |        5 |               1
 UA            |    1988 |        4 |               1
 US            |    1990 |        8 |               1
 WN            |    1996 |        2 |               0
 UA            |    2008 |        6 |               0
 EA            |    1990 |        7 |               0
 CO            |    1987 |       11 |               0
 UA            |    1990 |       12 |               0
 NW            |    1997 |        7 |               0
 DL            |    2005 |        9 |               0
 WN            |    1989 |       12 |               0
 AA            |    1989 |       11 |               0
 UA            |    2002 |       10 |               0
 UA            |    2008 |        5 |               0
 US            |    2003 |        2 |               0
 MQ            |    2006 |       11 |               0
 XE            |    2004 |       12 |               0
 UA            |    2000 |       11 |               0
 EV            |    2003 |        9 |               0
 AA            |    1990 |        6 |               0
 CO            |    2006 |       11 |               0
 NW            |    1999 |        2 |               0
 EV            |    2004 |       10 |               0
 US            |    2008 |       10 |               0
 US            |    1989 |        2 |               0
 AQ            |    2001 |        3 |               0
 DL            |    1999 |        5 |               0
 NW            |    1992 |       11 |               0

.


#6
SELECT tailnum, SUM(distance) as total_distance 
FROM flights
GROUP BY tailnum
ORDER BY total_distance DESC
LIMIT 10
OFFSET 2;


 tailnum | total_distance
---------+----------------
 N543UA  |           7675
 N12238  |           6829
 N580JB  |           6277
 N5DCAA  |           5300
 N637DL  |           5223
 N5DJAA  |           5046
 N653UA  |           5005
 N614UA  |           4950
 N615DL  |           4948
 N128DL  |           4584
(10 righe)


#7
SELECT uniquecarrier, AVG(arrdelay) AS average_delay 
FROM flights
GROUP BY uniquecarrier
HAVING AVG(arrdelay) > 10
ORDER BY average_delay DESC;

 uniquecarrier |    average_delay
---------------+---------------------
 TZ            | 38.5714285714285714
 F9            | 32.8571428571428571
 B6            | 20.3611111111111111
 PI            | 17.7272727272727273
 9E            | 16.4000000000000000
 YV            | 13.2727272727272727
 EV            | 13.0724637681159420
 OH            | 12.9310344827586207
 FL            | 12.0434782608695652
(9 righe)


